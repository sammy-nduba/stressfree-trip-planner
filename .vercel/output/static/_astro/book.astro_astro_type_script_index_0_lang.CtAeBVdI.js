import{s as I}from"./supabase.YjAYv7ih.js";const d={pkg},m=document.getElementById("booking-form"),g=document.getElementById("start-date"),l=document.getElementById("end-date"),a=document.getElementById("adults"),s=document.getElementById("children"),v=document.getElementById("adults-minus"),y=document.getElementById("adults-plus"),E=document.getElementById("children-minus"),h=document.getElementById("children-plus"),k=document.getElementById("summary-travelers"),b=document.getElementById("total-amount"),o=document.getElementById("submit-booking"),c=document.getElementById("error-message"),p=new Date().toISOString().split("T")[0];g.min=p;l.min=p;g.addEventListener("change",t=>{l.min=t.target.value,n()});l.addEventListener("change",()=>{n()});v.addEventListener("click",()=>{const t=parseInt(a.value);t>1&&(a.value=t-1,n())});y.addEventListener("click",()=>{const t=parseInt(a.value);t<10&&(a.value=t+1,n())});E.addEventListener("click",()=>{const t=parseInt(s.value);t>0&&(s.value=t-1,n())});h.addEventListener("click",()=>{const t=parseInt(s.value);t<10&&(s.value=t+1,n())});function n(){const t=parseInt(a.value),e=parseInt(s.value),r=(t+e)*d.price;k.textContent=`${t} adult${t!==1?"s":""}, ${e} child${e!==1?"ren":""}`,b.textContent=`$${r}`}n();m.addEventListener("submit",async t=>{t.preventDefault(),o.disabled=!0,o.textContent="Creating Booking...",c.classList.add("hidden");try{const e=new FormData(m),i={package_id:d.id,travel_dates:{start_date:e.get("startDate"),end_date:e.get("endDate")},participants:{adults:parseInt(e.get("adults")),children:parseInt(e.get("children"))},special_requests:e.get("specialRequests"),total_price:B(),status:"pending"},{data:r,error:u}=await I.from("bookings").insert([i]).select().single();if(u)throw u;window.location.href=`/packages/book/${r.id}/payment`}catch(e){console.error("Error creating booking:",e),c.textContent=e.message||"Failed to create booking. Please try again.",c.classList.remove("hidden"),o.disabled=!1,o.textContent="Proceed to Payment"}});function B(){const t=parseInt(a.value),e=parseInt(s.value);return(t+e)*d.price}
